你想要学习数据校验规则设计，核心任务是掌握字段类型校验、逻辑一致性校验两种方法，编写能检查问答数据中“问题为空”“答案过短（少于10字）”的校验函数，并将该函数应用到校园问答数据集上，完成无效数据的校验与删除。

### 一、先理解核心数据校验方法
在开始编写代码前，先清晰掌握你需要学习的两种校验方法：

| 校验方法         | 核心定义                                                                 | 适用场景举例                     |
|------------------|--------------------------------------------------------------------------|----------------------------------|
| 字段类型校验     | 检查数据字段的**数据类型**是否符合预设规则（如字符串、数字、布尔值等）| 问题/答案必须是字符串类型，不能是None/数字 |
| 逻辑一致性校验   | 检查数据是否符合业务逻辑规则（如长度、范围、关联关系等）| 答案长度≥10字、问题不能为空字符串 |

### 二、编写数据校验函数
基于你的需求，我们编写一个健壮的校验函数，同时处理**字段类型**和**逻辑一致性**校验，重点检查“问题为空”“答案过短”两个核心规则：

```python
def validate_qa_data(qa_item):
    """
    校验单条问答数据的有效性
    :param qa_item: 字典格式的问答数据，需包含 'question' 和 'answer' 字段
    :return: tuple (is_valid: bool, error_msg: str)
             is_valid: 数据是否有效（True/False）
             error_msg: 无效时的错误信息，有效时为空字符串
    """
    # 1. 字段类型校验：检查是否包含必要字段，且字段类型为字符串
    required_fields = ['question', 'answer']
    for field in required_fields:
        if field not in qa_item:
            return False, f"缺少必要字段：{field}"
        if not isinstance(qa_item[field], str):
            return False, f"{field}字段类型错误，必须是字符串（当前类型：{type(qa_item[field])}）"
    
    # 2. 逻辑一致性校验：处理空格后检查核心规则
    # 去除问题前后的空格（避免"   "这种空字符串被误判为有效）
    question = qa_item['question'].strip()
    # 去除答案前后的空格（避免"   123   "这种短字符串被误判）
    answer = qa_item['answer'].strip()
    
    # 检查问题是否为空
    if not question:
        return False, "问题为空（包含纯空格的情况）"
    
    # 检查答案是否过短（<10字）
    if len(answer) < 10:
        return False, f"答案过短（当前{len(answer)}字，要求≥10字）：{answer}"
    
    # 所有校验通过
    return True, ""
```

#### 函数关键说明：
1. **字段类型校验**：先检查是否有`question`/`answer`字段，再确保字段类型是字符串（避免传入数字/None等无效类型）；
2. **空格处理**：用`strip()`去除字符串前后空格，避免“纯空格的空问题”“带空格的短答案”被误判；
3. **返回值设计**：返回“是否有效+错误信息”，方便后续定位无效数据的原因。

### 三、实操：校验校园问答数据集并删除无效数据
我们模拟一个校园问答数据集，然后应用上述函数完成校验和无效数据删除：

```python
# 模拟校园问答数据集（包含有效、无效数据）
campus_qa_dataset = [
    {"question": "图书馆几点关门？", "answer": "图书馆周一到周五22点关门，周末21点关门"},  # 有效
    {"question": "", "answer": "开学时间是9月1日"},  # 问题为空
    {"question": "食堂有清真窗口吗？", "answer": "有"},  # 答案过短
    {"question": "   ", "answer": "宿舍限电功率是800瓦"},  # 问题为纯空格
    {"question": "补考怎么申请？", "answer": "   补考需在成绩公布后3天内找辅导员提交申请表格   "},  # 有效（去空格后长度足够）
    {"question": 123, "answer": "奖学金申请条件看学生手册"},  # 问题类型错误
    {"question": "选修课怎么选？", "answer": "登录教务系统，在选课板块选择即可"}  # 有效
]

# 校验数据集，筛选有效数据
valid_data = []
invalid_data = []

for idx, qa in enumerate(campus_qa_dataset):
    is_valid, error = validate_qa_data(qa)
    if is_valid:
        valid_data.append(qa)
    else:
        invalid_data.append({
            "index": idx,
            "data": qa,
            "error": error
        })

# 输出结果
print("===== 校验结果 =====")
print(f"原始数据总数：{len(campus_qa_dataset)}")
print(f"有效数据数：{len(valid_data)}")
print(f"无效数据数：{len(invalid_data)}")

print("\n===== 无效数据详情 =====")
for item in invalid_data:
    print(f"序号：{item['index']} | 错误：{item['error']} | 数据：{item['data']}")

print("\n===== 筛选后的有效数据 =====")
for idx, valid_qa in enumerate(valid_data):
    print(f"{idx+1}. 问题：{valid_qa['question']} | 答案：{valid_qa['answer']}")

# 最终保留的有效数据集（可直接用于后续分析）
final_valid_dataset = valid_data
```

#### 代码执行结果（示例）：
```
===== 校验结果 =====
原始数据总数：7
有效数据数：3
无效数据数：4

===== 无效数据详情 =====
序号：1 | 错误：问题为空（包含纯空格的情况） | 数据：{'question': '', 'answer': '开学时间是9月1日'}
序号：2 | 错误：答案过短（当前1字，要求≥10字）：有 | 数据：{'question': '食堂有清真窗口吗？', 'answer': '有'}
序号：3 | 错误：问题为空（包含纯空格的情况） | 数据：{'question': '   ', 'answer': '宿舍限电功率是800瓦'}
序号：5 | 错误：question字段类型错误，必须是字符串（当前类型：<class 'int'>） | 数据：{'question': 123, 'answer': '奖学金申请条件看学生手册'}

===== 筛选后的有效数据 =====
1. 问题：图书馆几点关门？ | 答案：图书馆周一到周五22点关门，周末21点关门
2. 问题：补考怎么申请？ | 答案：   补考需在成绩公布后3天内找辅导员提交申请表格   
3. 问题：选修课怎么选？ | 答案：登录教务系统，在选课板块选择即可
```

### 总结
1. **核心校验方法**：字段类型校验关注“数据类型是否合规”，逻辑一致性校验关注“业务规则是否满足”；
2. **校验函数关键**：需先处理空格等边缘情况，再检查核心规则（问题非空、答案≥10字），同时返回错误信息便于排查；
3. **实操核心**：遍历数据集逐行校验，分离有效/无效数据，最终保留的`final_valid_dataset`即为清理后的可用数据。

如果你的真实数据集是CSV/Excel格式，只需在代码开头添加读取文件的逻辑（如用`pandas`的`read_csv`），再将每行数据转为字典格式传入校验函数即可。